1. Pull total number of orders that were completed on 18th March 2023


SELECT COUNT(*)
FROM sales
WHERE date = “03-18-2023”;


2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’


SELECT COUNT(*)
FROM sales
INNER JOIN customer
ON sales.customer_Id = customer.customer_id
WHERE sales.date = “03-01-2023” and customer.first_name = ‘John’ and customer.last_name = “doe’;


3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer


SELECT COUNT(distinct customer_id), AVG(TotalRevenue)
FROM customers c
LEFT JOIN (
        SELECT customer_id,sum(revenue) AS TotalRevenue
        FROM sales 
        WHERE date BETWEEN ”01-01-2023” AND “01-31-2023”
        GROUP BY customer_id 
        ) AS s 
ON c.customer_id = s.customer_id;


4. Pull the departments that generated less than $600 in 2022
SELECT items.department
FROM items 
LEFT JOIN sales
ON items.item_id = sales.item_id
WHERE sales.date LIKE “%-%-2022” 
GROUP BY items.department
HAVING SUM(revenue) <600;


5. What is the most and least revenue we have generated by an order


SELECT MAX(revenue), MIN(revenue), order_id
FROM sales


6. What were the items that were purchased in our most lucrative order


SELECT i.item_id, i.item_name
FROM items i
JOIN sales s
ON i.item_id = s.item_id
Where revenue = (SELECT MAX(revenue)
FROM sales);